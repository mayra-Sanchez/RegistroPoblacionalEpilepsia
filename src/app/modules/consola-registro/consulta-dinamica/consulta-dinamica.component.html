<div #dashboardContainer class="dashboard-container">
  <!-- Barra de controles simplificada -->
  <div class="controls-bar">
    <button mat-icon-button 
            (click)="refreshDashboard()" 
            [disabled]="isLoading" 
            matTooltip="Actualizar dashboard">
      <mat-icon>refresh</mat-icon>
    </button>
    
    <button mat-icon-button 
            (click)="openInNewTab()" 
            matTooltip="Abrir en nueva pestaÃ±a">
      <mat-icon>open_in_new</mat-icon>
    </button>

    <!-- Indicador de estado -->
    <span class="status-indicator" *ngIf="isLoading">
      <mat-spinner diameter="20"></mat-spinner>
      Cargando...
    </span>

    <span class="last-update" *ngIf="lastLoadTime && !isLoading">
      Actualizado: {{ lastLoadTime | date:'HH:mm:ss' }}
    </span>
  </div>

  <!-- Estado de error -->
  <div *ngIf="hasError" class="error-state">
    <mat-icon color="warn">error_outline</mat-icon>
    <h3>Error al cargar el dashboard</h3>
    <p>{{ errorMessage }}</p>
    <button mat-raised-button color="primary" (click)="refreshDashboard()">
      <mat-icon>refresh</mat-icon>
      Reintentar
    </button>
  </div>

  <!-- Iframe del dashboard -->
  <iframe #dashboardIframe
    [src]="dashboardUrl"
    width="100%"
    frameborder="0"
    (load)="onIframeLoad()"
    (error)="onIframeError()"
    [hidden]="!isIframeLoaded || hasError"
    class="superset-iframe"
    title="Dashboard de Superset">
  </iframe>
</div>