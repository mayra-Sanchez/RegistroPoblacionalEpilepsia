<div class="superset-container">
    <!-- Loading state -->
    <div *ngIf="loading" class="loading-state">
      <mat-spinner diameter="50"></mat-spinner>
      <p>Conectando con Superset...</p>
    </div>
  
    <!-- Error state -->
    <div *ngIf="error && !loading" class="error-state mat-elevation-z2">
      <mat-icon color="warn">error_outline</mat-icon>
      <p>{{ error }}</p>
      <button mat-raised-button color="primary" (click)="refreshDashboard()">
        <mat-icon>refresh</mat-icon>
        Reintentar conexión
      </button>
    </div>
  
    <!-- Embedded dashboard -->
    <div *ngIf="embedUrl && !loading && !error" class="dashboard-container mat-elevation-z4">
      <div class="dashboard-controls">
        <button mat-icon-button (click)="refreshDashboard()" matTooltip="Actualizar dashboard">
          <mat-icon>refresh</mat-icon>
        </button>
        
        <mat-slide-toggle [(ngModel)]="autoRefresh" (change)="toggleAutoRefresh()">
          Auto-refresco ({{ refreshRate / 1000 }}s)
        </mat-slide-toggle>
        
        <span class="last-refresh">
          <mat-icon>schedule</mat-icon>
          Última actualización: {{ lastRefresh | date:'mediumTime' }}
        </span>
      </div>
  
      <iframe
        [src]="embedUrl"
        frameborder="0"
        width="100%"
        height="800"
        style="border: none;"
        (load)="onIframeLoad()"
        title="Superset Dashboard Embed">
      </iframe>
    </div>
  </div>